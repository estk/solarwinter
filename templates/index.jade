extends layout

block content
  != page.html  
  div#log.newsection
    div.title
      hr.left
      span FLIGHT LOG
      hr.right

  div.container
    include author
    //- underscore helps us filter and sort our articles
    - var logarticles = _.chain(contents.articles._.directories).map(function(item) {
    -   // map articles to index pages of subdirectories of 'articles'
    -   return item.index
    - }).compact().sortBy(function(item) { // compact removes any directories w/o an index
    -   // sort them by date
    -   return -item.date
    - }).filter(function(item) {
    -   if (typeof item.metadata.published != "undefined") {
    -     return (item.metadata.published && 1 + item.metadata.tags.search(/log/))
    -   }else {
    -     return false
    -   }
    - }).first(5).value() // and finally take the first 5
    each article in logarticles
      article.post
        header
          h2= article.title
          p
            //-mixin author(article.metadata.author)
            //-p tags: #{article.metadata.tags}
        section.content!= article.intro
        if article.hasMore
          p.read-more
            a(href=article.url) read more
    //-a(href='archive.html')#archive Visit the archives!

  div#duo.newsection
    div.title
      hr.left
      span  SUNSEEKER DUO
      hr.right
    div.imgcontainer
      img(src="/articles/6-17-12/Sunseeker_Duo_067_corr.jpg")

  div.container
    - var duoarticles = _.chain(contents.articles._.directories).map(function(item) {
    -   // map articles to index pages of subdirectories of 'articles'
    -   return item.index
    - }).compact().sortBy(function(item) { // compact removes any directories w/o an index
    -   // sort them by date
    -   return -item.date
    - }).filter(function(item) {
    -   if (typeof item.metadata.tags != "undefined") {
    -     return (item.metadata.published && 1 + item.metadata.tags.search(/duo/))
    -   }else {
    -     return false
    -   }
    - }).first(5).value() // and finally take the first 5
    each article in duoarticles
      article.post
        header
          h2= article.title
            //-a(href=article.url)= article.title
          //-p
            //-mixin author(article.metadata.author)
            //-p tags: #{article.metadata.tags}
        section.content!= article.intro
        if article.hasMore
          p.read-more
            a(href=article.url) read more
    //-a(href='archive.html')#archive Visit the archives!


  div#partners.newsection
    div.title
      hr.left
      span PARTNERS
      hr.right
    div.imgcontainer
      img(src="/articles/6-17-12/Sunseeker_Duo_067_corr.jpg")

  div.container
    - var partnerarticles = _.chain(contents.partners.alliances._.directories).map(function(item) {
    -   return item.index
    - }).compact().sortBy(function(item) { 
    -   return -item.date
    - }).filter(function(item) {
    -     return item.metadata.published
    - }).first(5).value() // and finally take the first 5
    - var supportarticles = _.chain(contents.partners.support._.directories).map(function(item) {
    -   return item.index
    - }).compact().sortBy(function(item) { 
    -   return -item.date
    - }).filter(function(item) {
    -     return item.metadata.published
    - }).first(5).value() // and finally take the first 5

    h2 Technical Partnerships
    each article in partnerarticles
      article.post
        header
          h3= article.title
        section.content!= article.intro

    h2 Materials and Systems Support
    each article in supportarticles
      article.post
        header
          h3= article.title
        section.content!= article.intro


  div#heritage.newsection
    div.title
      hr.left
      span HERITAGE
      hr.right
    div.imgcontainer
      img(src="/articles/6-17-12/Sunseeker_Duo_067_corr.jpg")


  div#team.newsection
    div.title
      hr.left
      span TEAM
      hr.right
    div.imgcontainer
      img(src="/images/teamheader.jpg")

  div.container.team
    - var teamarticles = _.chain(contents.team._.directories).map(function(item) {
    -   // map articles to index pages of subdirectories of 'articles'
    -   return item.index
    - }).compact().sortBy(function(item) { // compact removes any directories w/o an index
    -   // sort them by date
    -   return -item.date
    - }).filter(function(item) {
    -     return item.metadata.published
    - }).value() 
    each article in teamarticles
      article.post
        header
          h2= article.title
            //-a(href=article.url)= article.title
          //-p
            //-mixin author(article.metadata.author)
            //-p tags: #{article.metadata.tags}
        section.content.clearfix!= article.intro
        if article.hasMore
          p.read-more
            a(href=article.url) read more
    //-a(href='archive.html')#archive Visit the archives!

  div#contact
    a(name="contact")
    p contact
  


